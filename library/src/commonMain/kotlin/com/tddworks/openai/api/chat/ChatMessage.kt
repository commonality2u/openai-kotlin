package com.tddworks.openai.api.chat

import kotlinx.serialization.SerialName
import kotlinx.serialization.Serializable

/**
 * Data class representing a user message.
 *
 * @property content The content of the message.
 * @property role The role of the message sender (user or assistant). Default is USER.
 */
@Serializable
sealed interface ChatMessage {
    val content: String
    val role: Role

    @Serializable
    data class SystemMessage(
        @SerialName("content")
        override val content: String,
        @SerialName("role")
        override val role: Role = Role.SYSTEM,
    ) : ChatMessage

    @Serializable
    data class UserMessage(
        @SerialName("content")
        override val content: String,
        @SerialName("role")
        override val role: Role = Role.USER,
    ) : ChatMessage

    @Serializable
    data class AssistantMessage(
        @SerialName("content")
        override val content: String,
        @SerialName("role")
        override val role: Role = Role.ASSISTANT,
        @SerialName("tool_calls")
        val toolCalls: List<ToolCall>? = null,
    ) : ChatMessage

    @Serializable
    data class ToolMessage(
        /**
         * The contents of the tool message.
         */
        @SerialName("content")
        override val content: String,
        /**
         * The role of the messages author, in this case tool.
         */
        @SerialName("role")
        override val role: Role = Role.TOOL,
        /**
         * Tool call that this message is responding to.
         */
        @SerialName("tool_call_id")
        val toolCallId: String,
    ) : ChatMessage
}

@Serializable
data class ToolCall(
    /**
     * id string
     * Required
     * The ID of the tool call.
     */
    @SerialName("id")
    val id: String,

    /**
     * string Required
     * The type of the tool. Currently, only function is supported.
     */
    @SerialName("type")
    val type: String,

    /**
     * object Required
     * The function that the model called.
     */
    @SerialName("function")
    val function: Function,
)

@Serializable
data class Function(
    /**
     * string Required
     * The name of the function to call.
     */
    @SerialName("name")
    val name: String,

    /**
     * object Required
     * The parameters to pass to the function.
     * The arguments to call the function with, as generated by the model in JSON format. Note that the model does not always generate valid JSON, and may hallucinate parameters not defined by your function schema. Validate the arguments in your code before calling your function.
     */
    @SerialName("arguments")
    val arguments: String,
)